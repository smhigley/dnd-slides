import{r as t,c as e,h as i}from"./p-ce29c58b.js";const s=["S","M","T","W","T","F","S"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o=["January","February","March","April","May","June","July","August","September","October","November","December"];let r=class{constructor(i){t(this,i),this.dateSelected=e(this,"dateSelected",7),this.contrast="none",this.columnheader="none",this.focusModel="cell",this.callFocus=!1,this.today=new Date}async focusDate(){console.log("focus date",this.focusRef),this.focusRef&&this.focusRef.focus()}watchMonth(){this.dates=this.generateMonthDates()}watchStartDate(){this.selectedDay?(this.activeDate=this.selectedDay.getDate(),this.selectedDay.getMonth()===this.month&&this.selectedDay.getFullYear()===this.year||(this.month=this.selectedDay.getMonth(),this.year=this.selectedDay.getFullYear(),this.generateMonthDates())):this.selectedDate=void 0}componentWillLoad(){this.selectedDate=this.selectedDay?this.selectedDay:void 0;const t=this.startDate?new Date(this.startDate):new Date;this.month=t.getMonth(),this.year=t.getFullYear(),this.activeDate=t.getDate(),this.generateMonthDates()}componentDidUpdate(){this.focusRef&&(this.callFocus&&this.focusRef.focus(),this.callFocus=!1)}render(){return i("div",{class:`wrapper contrast-${this.contrast}`},i("div",{class:"calendar-header"},i("button",{class:"month-nav","aria-label":`Previous month, ${o[this.month-1]}`,onClick:()=>{this.updateActiveMonth(this.month-1)}},i("svg",{"aria-hidden":"true",viewBox:"0 0 20 20"},i("path",{d:"M13.891 17.418c0.268 0.272 0.268 0.709 0 0.979s-0.701 0.271-0.969 0l-7.83-7.908c-0.268-0.27-0.268-0.707 0-0.979l7.83-7.908c0.268-0.27 0.701-0.27 0.969 0s0.268 0.709 0 0.979l-7.141 7.419 7.141 7.418z"}))),i("span",{id:"dnd-calendar-caption",class:"month-title","aria-live":"polite","aria-atomic":"true"},o[this.month]," ",this.year),i("button",{class:"month-nav","aria-label":`Next month, ${o[this.month+1]}`,onClick:()=>{this.updateActiveMonth(this.month+1)}},i("svg",{"aria-hidden":"true",viewBox:"0 0 20 20"},i("path",{d:"M13.25 10l-7.141-7.42c-0.268-0.27-0.268-0.707 0-0.979 0.268-0.27 0.701-0.27 0.969 0l7.83 7.908c0.268 0.271 0.268 0.709 0 0.979l-7.83 7.908c-0.268 0.271-0.701 0.27-0.969 0s-0.268-0.707 0-0.979l7.141-7.417z"})))),i("table",{role:"grid",class:"grid","aria-labelledby":"dnd-calendar-caption",onKeyDown:this.onKeydown.bind(this)},i("thead",{role:"rowgroup",class:"grid-header"},i("tr",{role:"row",class:"row"},s.map(((t,e)=>i("th",{role:"columnheader",class:{"column-header":!0},"aria-label":"ariaLabel"===this.columnheader?a[e]:null,abbr:"abbr"===this.columnheader?a[e]:null},"text"===this.columnheader?i("span",{class:"visuallyHidden"},a[e]):null,i("span",{"aria-hidden":"text"===this.columnheader?"true":null},t)))))),i("tbody",{role:"rowgroup",class:"grid-body"},this.dates.map(((t=[],e)=>i("tr",{role:"row",class:"row"},t.map(((t,i)=>this.renderCell(t,e,i)))))))))}generateMonthDates(){const{month:t,year:e}=this,i=new Date(e,t,1).getDay(),s=new Date(e,t+1,0).getDate(),a=[];let o=1-i,r=[];for(;o<=s;)7===r.length&&(a.push(r),r=[]),r.push(o<1?void 0:o),o++;for(;r.length<7;)r.push(void 0);return a.push(r),a}isSameDay(t,e){return!(!t||!e)&&t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}onDateHighlightOn(t,e){this.activeDayColumn=e,this.activeWeek=t}onDateHighlightOff(){this.activeDayColumn=void 0,this.activeWeek=void 0}onDateClick(t){t&&(this.activeDate=t,this.selectDate(t))}onKeydown(t){let e=this.activeDate,i=this.month;switch(t.key){case"ArrowUp":e-=7;break;case"ArrowDown":e+=7;break;case"ArrowLeft":e-=1;break;case"ArrowRight":e+=1;break;case"Home":e=1;break;case"End":e=new Date(this.year,this.month+1,0).getDate();break;case" ":case"Enter":this.selectDate(e),t.preventDefault(),t.stopPropagation();break;case"PageUp":i-=1;break;case"PageDown":i+=1}(this.updateActiveMonth(i)||this.updateActiveDate(e))&&(this.callFocus=!0,t.preventDefault(),t.stopPropagation())}renderCell(t,e,s){let a=!1,o=!1,r=!1;if("number"==typeof t){const e=new Date(this.year,this.month,t);a=t===this.activeDate,o=this.isSameDay(e,this.today),r=this.selectedDate&&this.isSameDay(e,this.selectedDate)}const h="cell"===this.focusModel||"dual"===this.focusModel,n=()=>{this.onDateClick(t)};return i("td",{role:"gridcell",id:`date-${t}`,class:{cell:!0,today:o,selected:r,highlight:e===this.activeWeek||s===this.activeDayColumn},"aria-selected":`${r}`,"aria-current":o?"date":null,tabIndex:h?a?0:-1:null,ref:h&&a?t=>{this.focusRef=t}:null,onClick:n,onBlur:()=>this.onDateHighlightOff(),onFocus:t?()=>this.onDateHighlightOn(e,s):null,onMouseEnter:t?()=>this.onDateHighlightOn(e,s):null,onMouseLeave:()=>this.onDateHighlightOff()},t?"cell"!==this.focusModel?i("button",{class:"date-button",onClick:n,tabIndex:!h&&a?0:-1,ref:!h&&a?t=>{this.focusRef=t}:null},t):i("span",{class:"date-button"},t):i("span",null))}selectDate(t){this.isSameDay(new Date(this.year,this.month,t),this.selectedDate)||(this.selectedDate=new Date(this.year,this.month,t),this.dateSelected.emit(this.selectedDate))}updateActiveDate(t){if(t!==this.activeDate){const e=new Date(this.year,this.month,t);return this.year=e.getFullYear(),this.month=e.getMonth(),this.activeDate=e.getDate(),!0}return!1}updateActiveMonth(t){if(t!==this.month){const e=new Date(this.year,t,1),i=new Date(this.year,t+1,0).getDate(),s=Math.min(i,this.activeDate);return this.year=e.getFullYear(),this.month=e.getMonth(),this.activeDate=s,!0}return!1}static get watchers(){return{month:["watchMonth"],year:["watchMonth"],selectedDay:["watchStartDate"]}}};r.style=".wrapper{display:flex;flex-direction:column;width:25em;background-color:#fff}.calendar-header{display:flex;align-items:center;justify-content:space-between;padding:0.5em}.month-nav{padding:0.5em;background-color:transparent;border:none;border-radius:3px}.contrast-none .month-nav{color:#d7d7d7}.month-nav:focus{outline:2px solid #000}.month-nav svg{display:block;width:1.5em;fill:currentColor}.month-title{font-size:1.25em}.grid{border:1px solid #e3e3e3;border-collapse:collapse}.grid-caption{border-bottom:1px solid #e3e3e3;padding:0.5em}.grid-header{position:relative;border-bottom:1px solid #e3e3e3;box-shadow:0 0 4px 0 rgba(0, 0, 0, 0.15)}.column-header{padding:0.5em 0}.row{border-bottom:1px solid #e3e3e3}.grid-header .row{border-bottom:none}.selection-indicator{display:block;height:1.6em;position:relative;width:1.6em}.cell{align-items:center;border-left:1px solid #e3e3e3;padding:0;outline:0}.cell:focus .date-button{outline:2px solid #000;outline-offset:2px}.cell:first-child,.col:first-child{border-left:0}.cell.highlight{background-color:#eeeeee}.cell.today{position:relative}.cell.today::after{content:'';display:block;position:absolute;top:10%;left:10%;width:80%;height:80%;border-radius:50%;background-color:rgba(0, 0, 0, 0.1)}.contrast-all .cell.today::after{content:'';display:block;position:absolute;left:calc(50% - 3px);top:auto;bottom:12%;width:6px;height:6px;border-radius:50%;background-color:#4741c1}.contrast-all .cell.selected.today::after{background-color:#fff}.date-button{box-sizing:border-box;display:block;position:relative;width:100%;padding:0.75em;background:transparent;border:none;border-radius:3px;color:inherit;text-align:center;font-size:1.25em}.selected .date-button{background-color:#4741c1;color:#fff;box-shadow:0 0 18px 2px #4741c1}.heading-cell{align-items:center;display:flex;flex-wrap:wrap;justify-content:space-between;padding:0.5em 1em}.visuallyHidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap}";const h=["January","February","March","April","May","June","July","August","September","October","November","December"];let n=class{constructor(e){t(this,e),this.contrast="none",this.columnheader="none",this.focusModel="cell",this.showInput=!1,this.open=!1,this.callFocus=!1}componentDidUpdate(){this.focusRef&&(this.callFocus&&this.focusRef.focus(),this.callFocus=!1)}render(){return i("div",{class:{"datepicker-wrapper":!0,open:this.open}},i("div",{class:"field-wrapper"},this.showInput?this.renderInput():null,i("button",{class:"datepicker-button","aria-label":`open calendar, ${this.formatDate(this.currentDate)}`,"aria-expanded":`${this.open}`,onClick:()=>this.updateOpen(!this.open),onKeyDown:this.onKeyDown.bind(this),ref:t=>this.buttonRef=t},this.showInput?null:this.currentDate?this.formatDate(this.currentDate):"Select a date",i("svg",{viewBox:"0 0 26 28"},i("path",{d:"M2 26h4.5v-4.5h-4.5v4.5zM7.5 26h5v-4.5h-5v4.5zM2 20.5h4.5v-5h-4.5v5zM7.5 20.5h5v-5h-5v5zM2 14.5h4.5v-4.5h-4.5v4.5zM13.5 26h5v-4.5h-5v4.5zM7.5 14.5h5v-4.5h-5v4.5zM19.5 26h4.5v-4.5h-4.5v4.5zM13.5 20.5h5v-5h-5v5zM8 7v-4.5c0-0.266-0.234-0.5-0.5-0.5h-1c-0.266 0-0.5 0.234-0.5 0.5v4.5c0 0.266 0.234 0.5 0.5 0.5h1c0.266 0 0.5-0.234 0.5-0.5zM19.5 20.5h4.5v-5h-4.5v5zM13.5 14.5h5v-4.5h-5v4.5zM19.5 14.5h4.5v-4.5h-4.5v4.5zM20 7v-4.5c0-0.266-0.234-0.5-0.5-0.5h-1c-0.266 0-0.5 0.234-0.5 0.5v4.5c0 0.266 0.234 0.5 0.5 0.5h1c0.266 0 0.5-0.234 0.5-0.5zM26 6v20c0 1.094-0.906 2-2 2h-22c-1.094 0-2-0.906-2-2v-20c0-1.094 0.906-2 2-2h2v-1.5c0-1.375 1.125-2.5 2.5-2.5h1c1.375 0 2.5 1.125 2.5 2.5v1.5h6v-1.5c0-1.375 1.125-2.5 2.5-2.5h1c1.375 0 2.5 1.125 2.5 2.5v1.5h2c1.094 0 2 0.906 2 2z"})))),i("div",{class:"popup"},i("dnd-calendar",{class:"calendar",ref:t=>this.calendarRef=t,contrast:this.contrast,columnheader:this.columnheader,focusModel:this.focusModel,startDate:this.currentDate,selectedDay:this.currentDate,onDateSelected:this.onDateSelect.bind(this)})))}formatDate(t){return t&&t instanceof Date?`${h[t.getMonth()]} ${t.getDate()}, ${t.getFullYear()}`:""}onDateSelect(t){this.currentDate=t.detail,this.updateOpen(!1),this.inputRef&&(this.inputRef.value=this.formatDate(this.currentDate))}onKeyDown(t){t.stopPropagation()}parseInput(t){const e=new Date(t);e&&!isNaN(e.getTime())?(this.currentDate=e,this.inputRef&&(this.inputRef.value=this.formatDate(e))):(this.currentDate=null,this.inputRef&&(this.inputRef.value="")),this.updateOpen(!1)}renderInput(){return i("input",{type:"text",class:"datepicker-input",onBlur:t=>this.parseInput(t.target.value),onKeyDown:this.onKeyDown.bind(this),ref:t=>this.inputRef=t})}updateOpen(t){t?setTimeout((()=>{this.calendarRef.focusDate()}),10):(this.buttonRef.focus(),console.log("focus button",this.buttonRef)),this.open=t}};n.style=".datepicker-wrapper{width:25em}.field-wrapper{display:flex;column-gap:0.5em;align-items:center}.datepicker-button{display:flex;column-gap:0.75em;padding:0.75em 1.5em;background-color:#4741c1;border:0;border-radius:6px;color:#fff;font-weight:bold;font-size:1.2em}.datepicker-button svg{width:1em;fill:currentColor}.datepicker-input{padding:0.75em 1.5em;font-size:1.2em}.popup{visibility:hidden;border:1px solid #e3e3e3;box-shadow:0 0 4px 0 rgba(0, 0, 0, 0.15)}.open .popup{visibility:visible}";export{r as dnd_calendar,n as dnd_datepicker}